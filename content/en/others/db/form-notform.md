---
title: 范式和反范式
categories:
  - 数据库
tags:
  - 数据库
abbrlink: 8c83c940
date: 2018-05-29 08:30:00
---
### 1. 第一范式(1NF)

1NF是对属性的**原子性**，要求属性具有原子性，不可再分解；

```
表：字段1、 字段2(字段2.1、字段2.2)、字段3 ......
```

### 2. 第二范式(2NF)

2NF是对记录的**惟一性**，要求记录有惟一标识，即实体的惟一性，即不存在部分依赖；

```
表：学号、课程号、姓名、学分;
```

这个表明显说明了两个事务:学生信息, 课程信息;由于非主键字段必须依赖主键，这里**学分依赖课程号**，**姓名依赖与学号**，所以不符合二范式。

**可能会存在问题：**

- `数据冗余:`，每条记录都含有相同信息；
- `删除异常：`删除所有学生成绩，就把课程信息全删除了；
- `插入异常：`学生未选课，无法记录进数据库；
- `更新异常：`调整课程学分，所有行都调整

### 3. 第三范式(3NF)

3NF是对字段的**冗余性**，要求任何字段不能由其他字段派生出来，它要求字段没有冗余，即不存在传递依赖；

```
表: 学号, 姓名, 年龄, 学院名称, 学院电话
```

因为存在**依赖传递**: (学号) → (学生)→(所在学院) → (学院电话) 。

**可能会存在问题：**

- `数据冗余:`有重复值；
- `更新异常：`有重复的冗余信息，修改时需要同时修改多条记录，否则会出现**数据不一致的情况** 。

### 4. 反范式

没有冗余的数据库设计可以做到。但是，没有冗余的数据库未必是最好的数据库，有时为了提高运行效率，就必须降低范式标准，适当保留冗余数据。具体做法是：在概念数据模型设计时遵守第三范式，降低范式标准的工作放到物理数据模型设计时考虑。降低范式就是增加字段，允许冗余，**达到以空间换时间的目的**。

例子：

```
比如订单表中加入商品的金额，为什么加入金额这样违反了第二范式，但是由于商品金额改变并不会影响当时购买时候的金
额。所以用冗余的办法来达到空间换时间的目的就不需要去联表查询
```

### 5. 范式和反范式的优缺点对比

- #### 范式

  - **优点**
    - 减少数据冗余，数据表更新小
    - 更新操作范式更快
    - 范式化的表比反范式更小
  - **缺点**
    - 查询需要进行多表关联查询可能导致性能降低
    - 更难进行索引的优化

- #### 反范式

  - **优点**
    - 可以减少联表查询提高查询效率
    - 更好的进行索引的优化
  - **缺点**
    - 如果冗余的数据需要随着更新，数据的维护比较难
    - 对数据的修改成本很高，因为需要修改很多记录